<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nakametpy.thermo module &mdash; NakaMetPy 2022.12.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nakametpy.util module" href="nakametpy.util.html" />
    <link rel="prev" title="nakametpy.kinematics module" href="nakametpy.kinematics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            NakaMetPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="nakametpy.html">nakametpy package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="nakametpy.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="nakametpy.cmaps.html">nakametpy.cmaps module</a></li>
<li class="toctree-l3"><a class="reference internal" href="nakametpy.constants.html">nakametpy.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="nakametpy.grads.html">nakametpy.grads module</a></li>
<li class="toctree-l3"><a class="reference internal" href="nakametpy.jma.html">nakametpy.jma module</a></li>
<li class="toctree-l3"><a class="reference internal" href="nakametpy.kinematics.html">nakametpy.kinematics module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">nakametpy.thermo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="nakametpy.util.html">nakametpy.util module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nakametpy.html#module-nakametpy">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NakaMetPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="nakametpy.html">nakametpy package</a></li>
      <li class="breadcrumb-item active">nakametpy.thermo module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/nakametpy.thermo.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-nakametpy.thermo">
<span id="nakametpy-thermo-module"></span><h1>nakametpy.thermo module<a class="headerlink" href="#module-nakametpy.thermo" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.density">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecular_weight_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.622</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.density" title="Permalink to this definition"></a></dt>
<dd><p>Calculate density.</p>
<p>This calculation must be given an air parcel’s pressure, temperature, and mixing ratio.
The implementation uses the formula outlined in <span id="id1">[Hobbs2006]</span> pg.67.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – dimensionless mass mixing ratio</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air.
(<span class="math notranslate nohighlight">\(\varepsilon\approx0.622\)</span>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding density of the parcel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="math notranslate nohighlight">
\[\rho = \frac{p}{R_dT_v}\]</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.dewpoint">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">dewpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#dewpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.dewpoint" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the ambient dewpoint given the vapor pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>e</strong> (<cite>numpy.ndarray</cite>) – Water vapor partial pressure [Pa]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dewpoint temperature</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.dewpoint_from_relative_humidity" title="nakametpy.thermo.dewpoint_from_relative_humidity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dewpoint_from_relative_humidity</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.saturation_vapor_pressure" title="nakametpy.thermo.saturation_vapor_pressure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_vapor_pressure</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">vapor_pressure</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function inverts the <span id="id2">[Bolton1980]</span> formula for saturation vapor
pressure to instead calculate the temperature. This yield the following
formula for dewpoint in degrees Celsius:</p>
<div class="math notranslate nohighlight">
\[T = \frac{243.5 \log(e / 6.112)}{17.67 - \log(e / 6.112)}\]</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.dewpoint_from_relative_humidity">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">dewpoint_from_relative_humidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#dewpoint_from_relative_humidity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.dewpoint_from_relative_humidity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the ambient dewpoint given air temperature and relative humidity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – relative humidity expressed as a ratio in the range 0 &lt; rh &lt;= 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dewpoint temperature</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.dewpoint" title="nakametpy.thermo.dewpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dewpoint</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.saturation_vapor_pressure" title="nakametpy.thermo.saturation_vapor_pressure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_vapor_pressure</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.dewpoint_from_specific_humidity">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">dewpoint_from_specific_humidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_humidity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#dewpoint_from_specific_humidity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.dewpoint_from_specific_humidity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the dewpoint from specific humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]</p></li>
<li><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dew point temperature</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0: </span>Changed signature from <code class="docutils literal notranslate"><span class="pre">(specific_humidity,</span> <span class="pre">temperature,</span> <span class="pre">pressure)</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.relative_humidity_from_mixing_ratio" title="nakametpy.thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.dewpoint_from_relative_humidity" title="nakametpy.thermo.dewpoint_from_relative_humidity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dewpoint_from_relative_humidity</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.equivalent_potential_temperature">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">equivalent_potential_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dewpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#equivalent_potential_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.equivalent_potential_temperature" title="Permalink to this definition"></a></dt>
<dd><p>Calculate equivalent potential temperature.</p>
<p>This calculation must be given an air parcel’s pressure, temperature, and dewpoint.
The implementation uses the formula outlined in <span id="id3">[Bolton1980]</span>:</p>
<p>First, the LCL temperature is calculated:</p>
<div class="math notranslate nohighlight">
\[T_{L}=\frac{1}{\frac{1}{T_{D}-56}+\frac{ln(T_{K}/T_{D})}{800}}+56\]</div>
<p>Which is then used to calculate the potential temperature at the LCL:</p>
<div class="math notranslate nohighlight">
\[\theta_{DL}=T_{K}\left(\frac{1000}{p-e}\right)^\kappa
\left(\frac{T_{K}}{T_{L}}\right)^{0.28r}\]</div>
<p>Both of these are used to calculate the final equivalent potential temperature:</p>
<div class="math notranslate nohighlight">
\[\theta_{E}=\theta_{DL}\exp\left[\left(\frac{3036.}{T_{L}}
-1.78\right)\times r(1+0.448r)\right]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Temperature of parcel [K]</p></li>
<li><p><strong>dewpoint</strong> (<cite>numpy.ndarray</cite>) – Dewpoint of parcel [K]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The equivalent potential temperature of the parcel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span id="id4">[Bolton1980]</span> formula for Theta-e is used, since according to
<span id="id5">[DaviesJones2009]</span> it is the most accurate non-iterative formulation
available.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.exner_function">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">exner_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#exner_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.exner_function" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Exner function.</p>
<div class="math notranslate nohighlight">
\[\Pi = \left( \frac{p}{p_0} \right)^\kappa\]</div>
<p>This can be used to calculate potential temperature from temperature (and visa-versa),
since</p>
<div class="math notranslate nohighlight">
\[\Pi = \frac{T}{\theta}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – total atmospheric pressure [Pa]</p></li>
<li><p><strong>reference_pressure</strong> (<cite>numpy.ndarray</cite>, optional) – The reference pressure against which to calculate the Exner function, defaults to
metpy.constants.P0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the Exner function at the given pressure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.potential_temperature" title="nakametpy.thermo.potential_temperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">potential_temperature</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">temperature_from_potential_temperature</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.k_index_2d">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">k_index_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t700</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rh850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rh700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#k_index_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.k_index_2d" title="Permalink to this definition"></a></dt>
<dd><p>相対湿度、気温(およびリファレンスのための気圧)からK指数を計算する。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Pressure level value [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – Dimensionless relative humidity</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>K Index in Kelvin</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula based on that from [George1960]</p>
<div class="math notranslate nohighlight">
\[KI = T_{850} - T_{500} + Td_{850} - \left(T_{700} - Td_{700}\right)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(KI\)</span> is K index</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(Td\)</span> is dew-point temperature</p></li>
</ul>
<p>Subscript means its pressure level</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.k_index_3d">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">k_index_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#k_index_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.k_index_3d" title="Permalink to this definition"></a></dt>
<dd><p>相対湿度、気温(およびリファレンスのための気圧)からK指数を計算する。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Pressure level value [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – Dimensionless relative humidity [0&lt;=rh&lt;=1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>K index</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula based on that from [George1960]</p>
<div class="math notranslate nohighlight">
\[KI = T_{850} - T_{500} + Td_{850} - \left(T_{700} - Td_{700}\right)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(KI\)</span> is K index</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(Td\)</span> is dew-point temperature</p></li>
</ul>
<p>Subscript means its pressure level</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.mixing_ratio">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">mixing_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part_press</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tot_press</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecular_weight_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.622</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#mixing_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.mixing_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mixing ratio of a gas.</p>
<p>This calculates mixing ratio given its partial pressure and the total pressure of
the air. There are no required units for the input arrays, other than that
they have the same units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_press</strong> (<cite>numpy.ndarray</cite>) – Partial pressure of the constituent gas [Pa]</p></li>
<li><p><strong>tot_press</strong> (<cite>numpy.ndarray</cite>) – Total air pressure Pa</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air
(<span class="math notranslate nohighlight">\(\varepsilon\approx0.622\)</span>).
水の分子量と空気の平均の分子量の比=18/28.8</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The (mass) mixing ratio, dimensionless (e.g. Kg/Kg or g/g)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is a straightforward implementation of the equation given in many places,
such as <span id="id6">[Hobbs1977]</span> pg.73:</p>
<div class="math notranslate nohighlight">
\[r = \varepsilon \frac{e}{p - e}\]</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.saturation_mixing_ratio" title="nakametpy.thermo.saturation_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_mixing_ratio</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">vapor_pressure</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.mixing_ratio_from_relative_humidity">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">mixing_ratio_from_relative_humidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relative_humidity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#mixing_ratio_from_relative_humidity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.mixing_ratio_from_relative_humidity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mixing ratio from relative humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_humidity</strong> (<cite>numpy.ndarray</cite>) – Relative Humidity [0&lt;=rh&lt;=1]
相対湿度
値は(0, 1]である必要がある</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]
気温</p></li>
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]
全圧</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dimensionless mixing ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula adapted from <span id="id7">[Hobbs1977]</span> pg. 74.</p>
<div class="math notranslate nohighlight">
\[w = (RH)(w_s)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(RH\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.relative_humidity_from_mixing_ratio" title="nakametpy.thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.saturation_mixing_ratio" title="nakametpy.thermo.saturation_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_mixing_ratio</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.mixing_ratio_from_specific_humidity">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">mixing_ratio_from_specific_humidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specific_humidity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#mixing_ratio_from_specific_humidity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.mixing_ratio_from_specific_humidity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mixing ratio from specific humidity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mixing ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula from <span id="id8">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[w = \frac{q}{1-q}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the specific humidity</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.mixing_ratio" title="nakametpy.thermo.mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixing_ratio</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.specific_humidity_from_mixing_ratio" title="nakametpy.thermo.specific_humidity_from_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">specific_humidity_from_mixing_ratio</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.potential_temperature">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">potential_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#potential_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.potential_temperature" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the potential temperature.</p>
<p>Uses the Poisson equation to calculation the potential temperature
given <cite>pressure</cite> and <cite>temperature</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The potential temperature corresponding to the temperature and
pressure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dry_lapse</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula:</p>
<div class="math notranslate nohighlight">
\[\Theta = T (P_0 / P)^\kappa\]</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.relative_humidity_from_dewpoint">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">relative_humidity_from_dewpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dewpt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#relative_humidity_from_dewpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.relative_humidity_from_dewpoint" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the relative humidity.</p>
<p>Uses temperature and dewpoint in celsius to calculate relative
humidity using the ratio of vapor pressure to saturation vapor pressures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
<li><p><strong>dewpoint</strong> (<cite>numpy.ndarray</cite>) – dewpoint temperature [K]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>relative humidity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.saturation_vapor_pressure" title="nakametpy.thermo.saturation_vapor_pressure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_vapor_pressure</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.relative_humidity_from_mixing_ratio">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">relative_humidity_from_mixing_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#relative_humidity_from_mixing_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.relative_humidity_from_mixing_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the relative humidity from mixing ratio, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – Dimensionless mass mixing ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative humidity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula based on that from <span id="id9">[Hobbs1977]</span> pg. 74.</p>
<div class="math notranslate nohighlight">
\[RH = \frac{w}{w_s}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(relative_humidity\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.mixing_ratio_from_relative_humidity" title="nakametpy.thermo.mixing_ratio_from_relative_humidity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixing_ratio_from_relative_humidity</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.saturation_mixing_ratio" title="nakametpy.thermo.saturation_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saturation_mixing_ratio</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.relative_humidity_from_specific_humidity">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">relative_humidity_from_specific_humidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specific_humidity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#relative_humidity_from_specific_humidity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.relative_humidity_from_specific_humidity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the relative humidity from specific humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature [K]</p></li>
<li><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative humidity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula based on that from <span id="id10">[Hobbs1977]</span> pg. 74. and <span id="id11">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[RH = \frac{q}{(1-q)w_s}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(relative_humidity\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is specific humidity</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.relative_humidity_from_mixing_ratio" title="nakametpy.thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.saturation_mixing_ratio">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">saturation_mixing_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tot_press</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#saturation_mixing_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.saturation_mixing_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the saturation mixing ratio of water vapor.</p>
<p>This calculation is given total pressure and the temperature. The implementation
uses the formula outlined in <span id="id12">[Hobbs1977]</span> pg.73.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tot_press</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure [Pa]</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The saturation mixing ratio, dimensionless</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.saturation_vapor_pressure">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">saturation_vapor_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#saturation_vapor_pressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.saturation_vapor_pressure" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the saturation water vapor (partial) pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The saturation water vapor (partial) pressure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">vapor_pressure</span></code>, <a class="reference internal" href="#nakametpy.thermo.dewpoint" title="nakametpy.thermo.dewpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dewpoint</span></code></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of temperature, dewpoint may be used in order to calculate
the actual (ambient) water vapor (partial) pressure.</p>
<p>The formula used is that from <span id="id13">[Bolton1980]</span> for T in degrees Celsius:</p>
<div class="math notranslate nohighlight">
\[6.112 e^\frac{17.67T}{T + 243.5}\]</div>
<p>下記の式は既にケルビンに直してある</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.showalter_stability_index">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">showalter_stability_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#showalter_stability_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.showalter_stability_index" title="Permalink to this definition"></a></dt>
<dd><p>500hPaにおける気温から850 hPaから500 hPaに断熱変化させた際の気温を引いた指数。
この計算では乾燥断熱減率のみを考慮しているため、湿潤断熱変化も含めたSSIを
求める方法が必要である。</p>
<div class="math notranslate nohighlight">
\[SSI = T_{500} - T_{850\rightarrow 500}^*\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.specific_humidity_from_mixing_ratio">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">specific_humidity_from_mixing_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixing_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#specific_humidity_from_mixing_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.specific_humidity_from_mixing_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the specific humidity from the mixing ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – mixing ratio</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Specific humidity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formula from <span id="id14">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[q = \frac{w}{1+w}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the specific humidity</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nakametpy.thermo.mixing_ratio" title="nakametpy.thermo.mixing_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixing_ratio</span></code></a>, <a class="reference internal" href="#nakametpy.thermo.mixing_ratio_from_specific_humidity" title="nakametpy.thermo.mixing_ratio_from_specific_humidity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixing_ratio_from_specific_humidity</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nakametpy.thermo.virtual_temperature">
<span class="sig-prename descclassname"><span class="pre">nakametpy.thermo.</span></span><span class="sig-name descname"><span class="pre">virtual_temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecular_weight_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.622</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nakametpy/thermo.html#virtual_temperature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nakametpy.thermo.virtual_temperature" title="Permalink to this definition"></a></dt>
<dd><p>Calculate virtual temperature.</p>
<p>This calculation must be given an air parcel’s temperature and mixing ratio.
The implementation uses the formula outlined in <span id="id15">[Hobbs2006]</span> pg.80.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature [K]</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – dimensionless mass mixing ratio</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air.
(<span class="math notranslate nohighlight">\(\varepsilon\approx0.622\)</span>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding virtual temperature of the parcel</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="math notranslate nohighlight">
\[T_v = T \frac{\text{w} + \varepsilon}{\varepsilon\,(1 + \text{w})}\]</div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nakametpy.kinematics.html" class="btn btn-neutral float-left" title="nakametpy.kinematics module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nakametpy.util.html" class="btn btn-neutral float-right" title="nakametpy.util module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, muchojp.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>